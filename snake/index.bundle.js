(()=>{"use strict";var e={607:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(623)),a=s(i(137)),r=s(i(668));let o=document.querySelector(".game-bar .buttons-container .icon-reload"),h=document.querySelector(".game-bar .buttons-container .icon-fullscreen"),l=document.querySelector(".game-bar .buttons-container .icon-pause"),u=new n.default(30,20),d=new class{constructor(){this.timer=0,this.timerInterval=void 0,this.timerTimeout=200}start(){this.reset(),this.resume()}resume(){void 0===this.timerInterval&&(this.timerInterval=setInterval(this.tick.bind(this),this.timerTimeout))}pause(){void 0!==this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=void 0)}stop(){this.pause()}reset(){this.timer=0,this.updateDisplay()}tick(){this.timer+=this.timerTimeout/1e3,this.updateDisplay()}formatDisplay(){let e=Math.floor(this.timer%60).toString(),t=Math.floor(this.timer/60).toString();return 1===e.length&&(e="0"+e),1===t.length&&(t="0"+t),t+":"+e}updateDisplay(){document.querySelector(".timer-value").innerHTML=this.formatDisplay()}};function c(e=!1){document.querySelector(".score-value").innerHTML=(u.snake.length+(e?1:0)).toString()}function m(){document.querySelector(".game-over").classList.remove("active"),u.start(),d.start(),d.updateDisplay(),c(),document.querySelector(".game-paused.active")&&(u.pause(),d.pause())}u.onFruitConsumed=()=>c(!0),u.onDeath=()=>{d.stop(),function(){let e=document.querySelector(".game-over");document.querySelector(".game-over .score").innerHTML=`<b>Score:</b> ${u.snake.length.toString()} - <b>Time:</b> ${d.formatDisplay()}`,e.classList.add("active")}()},new a.default(u.snake),new r.default;let p=document.querySelector(".game-container");p.insertBefore(u.element,p.firstChild),document.fullscreenEnabled&&h.removeAttribute("disabled"),document.onfullscreenchange=function(){document.fullscreenElement?(h.classList.remove("icon-fullscreen"),h.classList.add("icon-fullscreen-exit")):(h.classList.remove("icon-fullscreen-exit"),h.classList.add("icon-fullscreen"))},o.onclick=()=>{u.reset(),setTimeout(m,200)},h.onclick=function(){document.fullscreenElement?document.exitFullscreen():document.querySelector("html").requestFullscreen()},l.onclick=function(){document.querySelector(".game-paused").classList.toggle("active")?(l.classList.remove("icon-pause"),setTimeout((()=>l.classList.add("icon-play")),50),u.pause(),d.pause()):(l.classList.remove("icon-play"),setTimeout((()=>l.classList.add("icon-pause")),50),u.resume(),d.resume())},document.querySelector(".restart").onclick=m,m()},623:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(681)),a=s(i(896)),r=s(i(601));t.default=class{constructor(e,t,i=5,s=5){this.tileMap=new n.default(e,t),this.fruitsCount=i,this.startingSnakeLength=s,this.snake=new a.default(this.tileMap),this.snake.onDeath=()=>this.onDeath(),this.fruitConsumtionHandler=()=>{this.spawnFruit(),this.onFruitConsumed()}}get element(){return this.tileMap.element}onDeath(){}onFruitConsumed(){}start(){this.setup(),this.resume()}pause(){this.snake.pause()}resume(){if(!this.snake.spawned)throw new Error("The snake is not spawned for the game to resume, call .setup() first before resuming the game.");this.snake.resume()}setup(){this.snake.spawned&&this.reset(),this.spawnSnake(),this.spawnStartingFruits()}reset(){this.snake.destroy(),this.tileMap.clearEntities()}spawnSnake(){this.snake.respawn(Math.floor((this.tileMap.width+this.startingSnakeLength)/2),Math.floor(this.tileMap.height/2),this.startingSnakeLength)}spawnStartingFruits(){for(let e=0;e<this.fruitsCount;e++)this.spawnFruit()}spawnFruit(){let e=Math.floor(Math.random()*this.tileMap.width),t=Math.floor(Math.random()*this.tileMap.height);if(this.tileMap.getEntity(e,t))return void this.spawnFruit();let i=new r.default;i.onConsumtion=this.fruitConsumtionHandler,this.tileMap.addEntity(i,e,t)}}},668:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.gamepads={},this.gamepadZone=.8,window.addEventListener("gamepadconnected",(e=>{let t=e.gamepad;console.log("Gamepad Connected",t),this.gamepads[t.id]=t})),window.addEventListener("gamepaddisconnected",(e=>{let t=e.gamepad;console.log("Gamepad Disconnected",t),delete this.gamepads[t.id]}));let e=t=>{this.updateControllers(),requestAnimationFrame(e)};requestAnimationFrame(e)}updateControllers(){for(let e in this.gamepads){let t=this.gamepads[e],i=t.axes[0],s=t.axes[1];i>this.gamepadZone?this.emulateKeyboardButton("ArrowRight"):i<-this.gamepadZone&&this.emulateKeyboardButton("ArrowLeft"),s>this.gamepadZone?this.emulateKeyboardButton("ArrowDown"):s<-this.gamepadZone&&this.emulateKeyboardButton("ArrowUp")}}emulateKeyboardButton(e){document.dispatchEvent(new KeyboardEvent("keydown",{key:e})),document.dispatchEvent(new KeyboardEvent("keyup",{key:e}))}}},137:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});let i={ArrowUp:0,ArrowRight:1,ArrowDown:2,ArrowLeft:3,w:0,W:0,d:1,D:1,s:2,S:2,a:3,A:3};t.default=class{constructor(e){this.snake=e,document.addEventListener("keydown",this.onkeydown.bind(this))}onkeydown(e){!this.snake.paused&&e.key in i&&(this.snake.direction=i[e.key])}}},677:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this._className=e}get className(){return this._className}consumed(e){return!1}}},601:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(677));class a extends n.default{constructor(){super("fruit")}onConsumtion(){}consumed(e){return this.onConsumtion(),e.grow(),!1}}t.default=a},896:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(774)),a=[[0,-1],[1,0],[0,1],[-1,0]];t.default=class{constructor(e){this.pieces=[],this._headX=0,this._headY=0,this._direction=1,this.lastMovementDirection=1,this.movementInterval=void 0,this.movementHandler=this.move.bind(this),this.movementTimeout=200,this._grow=0,this.tileMap=e}get length(){return this.pieces.length}get spawned(){return 0!==this.pieces.length}get paused(){return void 0===this.movementInterval}get direction(){return this.lastMovementDirection}set direction(e){(this.lastMovementDirection+e)%2==1&&(this._direction=e)}get headX(){return this._headX}get headY(){return this._headY}onDeath(){}respawn(e,t,i=5){0!==this.length&&this.destroy();for(let s=0;s<i;s++){let i=new n.default;this.pieces.push(i),this.tileMap.addEntity(i,e-s,t)}this._headX=e,this._headY=t,this._direction=1,this.lastMovementDirection=1}destroy(){this.pause(),this.pieces.forEach((e=>this.tileMap.removeEntity(e))),this.pieces.splice(0),this._grow=0}resume(){if(0===this.pieces.length)throw new Error("Can't resume the snake's movement while it's not in existance (respawn it first).");void 0!==this.movementInterval&&this.pause(),this.tileMap.addEntity(this.pieces[0],this._headX,this._headY),this.movementInterval=setInterval(this.movementHandler,this.movementTimeout)}pause(){void 0!==this.movementInterval&&(clearInterval(this.movementInterval),this.movementInterval=void 0)}die(){this.pause(),this.onDeath()}grow(e=1){this._grow+=e}move(){let e;this.lastMovementDirection=this._direction,this._grow>0?(e=new n.default,this._grow--):(e=this.pieces.pop(),this.tileMap.removeEntity(e)),this.pieces.unshift(e);let t=a[this._direction],i=t[0],s=t[1];this._headX+=i,this._headY+=s,this._headX<0&&(this._headX=this.tileMap.width-1),this._headY<0&&(this._headY=this.tileMap.height-1),this._headX%=this.tileMap.width,this._headY%=this.tileMap.height;let r=this.tileMap.getEntity(this._headX,this._headY);r&&r.consumed(this)?this.die():this.tileMap.addEntity(e,this._headX,this._headY)}}},774:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(677));class a extends n.default{constructor(){super("snake-piece")}consumed(e){return!0}}t.default=a},533:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.element=document.createElement("div"),this._entity=null}get entity(){return this._entity}set entity(e){this._entity=e,this.element.className=e?e.className:""}}},681:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(i(533));t.default=class{constructor(e=30,t=20){this.element=document.createElement("div"),this._width=0,this._height=0,this.tiles=[],this.entities=new Map,this.element.className="snake-game",this.setDimensions(e,t)}get width(){return this._width}get height(){return this._height}setDimensions(e,t){let i=e*t;if(i>this.tiles.length)for(let e=this.tiles.length;e<i;e++){let e=new n.default;this.tiles.push(e),this.element.appendChild(e.element)}else if(i<this.tiles.length)for(let e=this.tiles.length;e>i;e--){const e=this.tiles.pop();this.element.removeChild(e.element)}this._width=e,this._height=t,this.element.style.gridTemplateColumns=`repeat(${this._width}, 1fr)`}addEntity(e,t,i){let s=i*this._width+t;const n=this.tiles[s].entity;n&&this.removeEntity(n),this.tiles[s].entity=e,this.entities.set(e,s)}getEntity(e,t){return this.tiles[t*this._width+e].entity}removeEntity(e){if(!this.entities.has(e))return;let t=this.entities.get(e);this.tiles[t].entity=null,this.entities.delete(e)}clearEntities(){this.entities.forEach((e=>this.tiles[e].entity=null)),this.entities.clear()}}}},t={};!function i(s){if(t[s])return t[s].exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,i),n.exports}(607)})();